<!-- Product Detail Start -->
<div class="container-fluid py-5">
  <div class="container py-5">
    <!-- Breadcrumb & Back -->
    <div class="row mb-4">
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="/">Home</a></li>
            <li class="breadcrumb-item"><a routerLink="/shop">Shop</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              {{ product?.name || 'Product' }}
            </li>
          </ol>
        </nav>
        <a routerLink="/shop" class="btn btn-outline-secondary rounded-pill btn-sm">
          <i class="fas fa-arrow-left me-2"></i>Back to Shop
        </a>
      </div>
    </div>

    <!-- Loading State -->
    @if (loading) {
      <div class="text-center py-5">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-muted">Loading product details...</p>
      </div>
    }

    <!-- Error State -->
    @if (error) {
      <div class="alert alert-danger d-flex align-items-center" role="alert">
        <i class="fas fa-exclamation-circle me-3 fa-2x"></i>
        <div>
          {{ error }}
          <button
            class="btn btn-outline-danger btn-sm ms-3"
            (click)="loadProduct(product?.id?.toString() || '')"
          >
            <i class="fas fa-sync-alt me-1"></i>Retry
          </button>
        </div>
      </div>
    }

    <!-- Product Details -->
    @if (!loading && !error && product) {
      <div class="row g-5">
        <!-- Product Image -->
        <div class="col-lg-6">
          <div class="border rounded p-3 text-center">
            <img
              [src]="selectedImage"
              class="img-fluid"
              [alt]="product.name"
              style="max-height: 400px"
            />
          </div>
          <!-- No additional images since product has only one -->
        </div>

        <!-- Product Info -->
        <div class="col-lg-6">
          <h1 class="display-6 mb-3">{{ product.name }}</h1>

          <!-- Rating -->
          @if (product.rating) {
            <div class="d-flex mb-3">
              @for (star of [1, 2, 3, 4, 5]; track star) {
                <i
                  class="fas fa-star"
                  [class.text-primary]="star <= product.rating"
                  [class.text-secondary]="star > product.rating"
                ></i>
              }
              <span class="ms-2 text-muted">({{ product.rating }} Reviews)</span>
            </div>
          }

          <!-- Price -->
          <div class="mb-4">
            @if (product.oldPrice) {
              <del class="text-muted fs-5 me-2">{{ product.oldPrice }}</del>
            }
            <span class="text-primary fs-1 fw-bold">{{ product.newPrice }}</span>
          </div>

          <!-- Availability -->
          <div class="mb-4">
            @if (product.inventory && product.inventory > 0) {
              <span class="badge bg-success rounded-pill py-2 px-3">In Stock</span>
              @if (product.inventory <= 10) {
                <span class="badge bg-warning text-dark rounded-pill py-2 px-3 ms-2"
                  >Only {{ product.inventory }} left!</span
                >
              }
            } @else {
              <span class="badge bg-danger rounded-pill py-2 px-3">Out of Stock</span>
            }
          </div>

          <!-- Description -->
          <div class="mb-4">
            <h5>Description</h5>
            <p class="text-muted">{{ product.description }}</p>
          </div>

          <!-- Badge (optional) -->
          @if (product.badge) {
            <div class="mb-3">
              <span
                class="badge"
                [class.bg-primary]="product.badge === 'New'"
                [class.bg-danger]="product.badge === 'Sale'"
              >
                {{ product.badge }}
              </span>
            </div>
          }

          <!-- Quantity & Actions -->
          <div class="mb-4">
            <div class="row g-3 align-items-center">
              <div class="col-auto">
                <label class="form-label">Quantity</label>
                <div class="input-group quantity" style="width: 150px">
                  <button
                    class="btn btn-outline-secondary btn-sm"
                    type="button"
                    (click)="decreaseQuantity()"
                  >
                    -
                  </button>
                  <input
                    type="text"
                    class="form-control form-control-sm text-center"
                    [value]="quantity"
                    readonly
                  />
                  <button
                    class="btn btn-outline-secondary btn-sm"
                    type="button"
                    (click)="increaseQuantity()"
                  >
                    +
                  </button>
                </div>
              </div>
              <div class="col">
                <button
                  class="btn btn-primary rounded-pill py-3 px-5 me-2"
                  (click)="addToCart()"
                  [disabled]="!product.inventory || product.inventory === 0"
                >
                  <i class="fas fa-shopping-cart me-2"></i>Add to Cart
                </button>
                <button
                  class="btn btn-success rounded-pill py-3 px-5"
                  (click)="buyNow()"
                  [disabled]="!product.inventory || product.inventory === 0"
                >
                  <i class="fas fa-bolt me-2"></i>Buy Now
                </button>
              </div>
            </div>
          </div>

          <!-- Product Meta -->
          <div class="bg-light p-4 rounded">
            <div class="row">
              <div class="col-6">
                <small class="text-muted d-block">SKU</small>
                <strong>{{ product.sku || 'N/A' }}</strong>
              </div>
              <div class="col-6">
                <small class="text-muted d-block">Category</small>
                <strong>{{ product.category }}</strong>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="row mt-5">
        <div class="col-12">
          <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
            <li class="nav-item" role="presentation">
              <button
                class="nav-link active"
                id="pills-description-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-description"
                type="button"
                role="tab"
              >
                Description
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button
                class="nav-link"
                id="pills-reviews-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-reviews"
                type="button"
                role="tab"
              >
                Reviews ({{ product.rating || 0 }})
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button
                class="nav-link"
                id="pills-shipping-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-shipping"
                type="button"
                role="tab"
              >
                Shipping
              </button>
            </li>
          </ul>
          <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-description" role="tabpanel">
              <p class="text-muted">{{ product.description || 'No description available.' }}</p>
            </div>
            <div class="tab-pane fade" id="pills-reviews" role="tabpanel">
              <p class="text-muted">Customer reviews will appear here.</p>
            </div>
            <div class="tab-pane fade" id="pills-shipping" role="tabpanel">
              <p class="text-muted">
                Free shipping on orders over $50. Estimated delivery: 3-5 business days.
              </p>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</div>
<!-- Product Detail End -->
